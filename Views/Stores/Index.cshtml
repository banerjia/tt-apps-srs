@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@using System.Globalization
@using Nest
@model IEnumerable<tt_apps_srs.Models.ESIndex_Store_Document>
@{
    TextInfo textInfo = new CultureInfo("en-US", false).TextInfo;
    var prms = Microsoft.AspNetCore.WebUtilities.QueryHelpers.ParseQuery(Context.Request.QueryString.Value);
    Dictionary<string, string> prms_route_data = new Dictionary<string, string>();

    foreach(var item in prms.Keys)
    {
        if (item.Equals("page", StringComparison.OrdinalIgnoreCase))
        {
            continue;
        }

        prms_route_data.Add(item, prms[item].ToString()   );
    }
}
<div class="row">
    <div class="col-12">

        <a asp-action="New" class="btn btn-success">
            <i class="fas fa-plus"></i>
            <span class="hidden-sm hidden-xs">Add New Store</span>
        </a>
    </div>
</div>
<div class="row">
    <div class="col-lg-7 col-md-7 col-sm-12 col-xs-12">
        <table class="table table-condensed table-striped">
            <thead class="thead-light">
                <tr>
                    <th scope="col">Name</th>
                    <th scope="col">City</th>
                    <th scope="col">State</th>
                    <th scope="col">Retailer</th>
                </tr>
            </thead>
            <tfoot>
                <tr>
                    <td colspan="2" class="text-left"><a asp-action="Index" asp-route-page="@((ushort)ViewData["page"] - 1)">Previous</a></td>
                    <td colspan="2" class="text-right"><a asp-action="Index" asp-route-page="@((ushort)ViewData["page"] + 1)">Next</a></td>
                </tr>
            </tfoot>
            <tbody>
                @foreach (var store in Model)
                {
                    <tr>
                        <td><a asp-action="Details" asp-route-id="@store.Id">@textInfo.ToTitleCase(store.Name.ToLower())</a></td>
                        <td>@textInfo.ToTitleCase(store.City.ToLower())</td>
                        <td>@store.State</td>
                        <td>@textInfo.ToTitleCase(store.Retailer.Name.ToLower())</td>
                    </tr>

                }

            </tbody>
        </table>
    </div>
    <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12">
        <h3>Retailers</h3>
        <ul id="retailer">
            @foreach (var retailer in (IReadOnlyCollection<KeyedBucket<string>>)ViewData["agg_retailers"])
            {
                string retailer_name = retailer.Key.Split('=').First();
                string retailer_id = retailer.Key.Split('=').Last();
                <text>
                    <li value="@retailer_id">@retailer_name (<a asp-action="Index" asp-route-q="retailer.id.keyword:@retailer_id">@retailer.DocCount</a>) </li>
                </text>
            }
        </ul>
        <h3>States</h3>
        <ul>
            @foreach (var state in (IReadOnlyCollection<KeyedBucket<string>>)ViewData["agg_states"])
            {
                <text>
                    <li>@state.Key (<a asp-action="Index" asp-route-q="state.keyword:@state.Key">@state.DocCount</a>)</li>
                </text>
            }
        </ul>
    </div>
</div>
